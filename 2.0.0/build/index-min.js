/*! kThrow - v2.0.0 - 2013-07-30 3:44:56 PM
* Copyright (c) 2013 Letao; Licensed  */
KISSY.add("kg/kThrow/2.0.0/index",function(a,b,c){function d(b){var c=this;return c instanceof d?(c.target=a.one(b.target),c.decay=b.decay&&b.decay>0&&b.delay<1?b.decay:.75,c.size=b.size||{w:200,h:200},c.timer=null,c.speedX=0,c.speedY=0,c.delay=b.delay||1,c.init(),void 0):new d(b)}var e=(b.all,a.DOM);return a.extend(d,c,{init:function(){var a=this;a._expandTarget(function(){a._startMove(),a._bindEvent()})},_expandTarget:function(a){var b=this,c=e.viewportWidth(),d=e.viewportHeight(),f=(c-b.size.w)/2,g=(d-b.size.h)/2;b.target.css({position:"absolute",width:0,height:0,left:"50%",top:"50%"}),b.target.animate({width:b.size.w,height:b.size.h,left:f,top:g},.3,"easeOutStrong",function(){setTimeout(function(){a&&a()},1e3*b.delay)})},_startMove:function(){var a=this;clearInterval(a.timer),a.timer=setInterval(function(){a.speedY+=3;var b=a.target.offset().top+a.speedY,c=a.target.offset().left+a.speedX,d=e.viewportWidth(),f=e.viewportHeight(),g=a.target.width(),h=a.target.height();0>b?(b=0,a.speedY*=-1,a.speedY=a.speedY*a.decay,a.speedY=a.speedY<0?Math.ceil(a.speedY):Math.floor(a.speedY),a.speedX=a.speedX*a.decay,a.speedX=a.speedX<0?Math.ceil(a.speedX):Math.floor(a.speedX)):b>f-h&&(b=f-h,a.speedY*=-1,a.speedY=a.speedY*a.decay,a.speedY=a.speedY<0?Math.ceil(a.speedY):Math.floor(a.speedY),a.speedX=a.speedX*a.decay,a.speedX=a.speedX<0?Math.ceil(a.speedX):Math.floor(a.speedX)),0>c?(c=0,a.speedX*=-1,a.speedX=a.speedX*a.decay,a.speedX=a.speedX<0?Math.ceil(a.speedX):Math.floor(a.speedX)):c>d-g&&(c=d-g,a.speedX*=-1,a.speedX=a.speedX*a.decay,a.speedX=a.speedX<0?Math.ceil(a.speedX):Math.floor(a.speedX)),a.target.css({left:c,top:b})},25)},_bindEvent:function(){var b=this,c=0,d=0,f=b.target.width(),g=b.target.height(),h=0,i=0;b.target.on("mousedown",function(j){clearInterval(b.timer);var k=e.viewportWidth(),l=e.viewportHeight();c=j.clientX,d=j.clientY,h=j.clientX-b.target.offset().left,i=j.clientY-b.target.offset().top,a.one(document).on("mousemove",function(a){b.speedX=a.clientX-c,b.speedY=a.clientY-d,c=a.clientX,d=a.clientY;var e=a.clientX-h,j=a.clientY-i;0>e?e=0:e>k-f&&(e=k-f),0>j?j=0:j>l-g&&(j=l-g),b.target.css({left:e,top:j})}).on("mouseup",function(){a.one(document).detach("mousemove mouseup"),b._startMove()}).on("selectstart",function(){return!1})})}},{ATTRS:{}}),d},{requires:["node","base"]});